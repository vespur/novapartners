<style>
  .case-studies {
    width: 100%;
    background-color: {{property.bgColor}};
    padding: {{property.desktopPaddingY}}px {{property.desktopPaddingX}}px;
  }

  .case-studies-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .case-studies-header {
    text-align: center;
    margin-bottom: {{property.desktopCardGap * 3}}px;
  }

  .case-studies-title {
    font-family: var(--font-family-heading);
    font-size: {{property.desktopTitleFontSize}}px;
    font-weight: {{property.desktopTitleFontWeight}};
    color: {{property.desktopTitleColor}};
    margin: 0 0 12px 0;
  }

  .case-studies-title[data-animated] {
    animation-timing-function: ease;
    animation-fill-mode: forwards;
  }

  .case-studies-subtitle {
    font-family: var(--font-family-body);
    font-size: 16px;
    color: #666666;
    margin: 0;
  }

  .case-studies-subtitle[data-animated] {
    animation-timing-function: ease;
    animation-fill-mode: forwards;
  }

  .case-studies-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: {{property.desktopCardGap}}px;
  }

  .case-card {
    background-color: {{property.caseCardBgColor}};
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    transition: all 0.3s ease;
  }

  .case-card[data-animated] {
    animation-timing-function: ease;
    animation-fill-mode: forwards;
  }

  .case-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  }

  .case-card-header {
    padding: 24px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .case-company-logo {
    width: {{property.desktopLogoSize}}px;
    height: {{property.desktopLogoSize}}px;
    border-radius: 8px;
    background-color: rgba(0, 0, 0, 0.05);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .case-company-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 4px;
  }

  .case-company-info {
    flex: 1;
  }

  .case-company-name {
    font-family: var(--font-family-body);
    font-size: {{property.desktopCompanyNameFontSize}}px;
    font-weight: {{property.desktopCompanyNameFontWeight}};
    color: #000000;
    margin: 0 0 4px 0;
  }

  .case-company-industry {
    font-family: var(--font-family-body);
    font-size: 12px;
    color: #999999;
    margin: 0;
  }

  .case-card-body {
    padding: 24px;
  }

  .case-section {
    margin-bottom: 20px;
  }

  .case-section:last-child {
    margin-bottom: 0;
  }

  .case-section-label {
    font-family: var(--font-family-body);
    font-size: 11px;
    font-weight: 600;
    color: #999999;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0 0 8px 0;
  }

  .case-section-content {
    font-family: var(--font-family-body);
    font-size: {{property.desktopTextFontSize}}px;
    color: {{property.desktopTextColor}};
    line-height: 1.6;
    margin: 0;
  }

  .case-results {
    padding: 16px;
    background-color: {{property.metricBgColor}};
    border-radius: 8px;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }

  .case-result-item {
    text-align: center;
  }

  .case-result-value {
    font-family: var(--font-family-body);
    font-size: 24px;
    font-weight: 700;
    color: {{property.metricValueColor}};
    margin: 0 0 4px 0;
  }

  .case-result-label {
    font-family: var(--font-family-body);
    font-size: 12px;
    color: #666666;
    margin: 0;
  }

  /* 성능 최적화 */
  .case-studies {
    transform: translateZ(0);
    backface-visibility: hidden;
  }

  /* 애니메이션 정의 */
  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slideInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* 모바일 반응형 */
  @media (max-width: 768px) {
    .case-studies {
      padding: {{property.mobilePaddingY}}px {{property.mobilePaddingX}}px;
    }

    .case-studies-header {
      margin-bottom: {{property.mobileCardGap * 2}}px;
    }

    .case-studies-title {
      font-size: {{property.mobileTitleFontSize}}px;
      font-weight: {{property.mobileTitleFontWeight}};
    }

    .case-studies-grid {
      grid-template-columns: 1fr;
      gap: {{property.mobileCardGap}}px;
    }

    .case-card-header {
      padding: 16px;
    }

    .case-company-logo {
      width: {{property.mobileLogoSize}}px;
      height: {{property.mobileLogoSize}}px;
    }

    .case-company-name {
      font-size: {{property.mobileCompanyNameFontSize}}px;
    }

    .case-card-body {
      padding: 16px;
    }

    .case-section {
      margin-bottom: 16px;
    }

    .case-section-content {
      font-size: {{property.mobileTextFontSize}}px;
    }

    .case-results {
      padding: 12px;
    }

    .case-result-value {
      font-size: 20px;
    }
  }
</style>

<template>
  <div class="case-studies">
    <div class="case-studies-container">
      <div class="case-studies-header">
        {{#if property.sectionTitle}}
          <h2 class="case-studies-title">{{property.sectionTitle}}</h2>
        {{/if}}
        {{#if property.sectionSubtitle}}
          <p class="case-studies-subtitle">{{property.sectionSubtitle}}</p>
        {{/if}}
      </div>

      {{#if property.caseStudies}}
        <div class="case-studies-grid">
          {{#each property.caseStudies}}
            <div class="case-card">
              <div class="case-card-header">
                {{#if companyLogo}}
                  <div class="case-company-logo">
                    <img src="{{companyLogo}}" alt="{{companyName}}" />
                  </div>
                {{else}}
                  <div class="case-company-logo"></div>
                {{/if}}
                <div class="case-company-info">
                  {{#if companyName}}
                    <h3 class="case-company-name">{{companyName}}</h3>
                  {{/if}}
                  {{#if industry}}
                    <p class="case-company-industry">{{industry}}</p>
                  {{/if}}
                </div>
              </div>

              <div class="case-card-body">
                {{#if challenge}}
                  <div class="case-section">
                    <p class="case-section-label">당면 과제</p>
                    <p class="case-section-content">{{challenge}}</p>
                  </div>
                {{/if}}

                {{#if solution}}
                  <div class="case-section">
                    <p class="case-section-label">제공된 솔루션</p>
                    <p class="case-section-content">{{solution}}</p>
                  </div>
                {{/if}}

                {{#if results}}
                  <div class="case-section">
                    <p class="case-section-label">성과 지표</p>
                    <p class="case-section-content" style="color: {{../property.metricValueColor}}; font-weight: 600;">{{results}}</p>
                  </div>
                {{/if}}
              </div>
            </div>
          {{/each}}
        </div>
      {{/if}}
    </div>
  </div>
</template>

<script>
  const container = bm.container;
  const context = bm.context;

  function initCaseStudies() {
    try {
      // 애니메이션 설정
      if (bm.property && bm.property.enableAnimation) {
        const animationType = bm.property.animationType || 'fadeInLeft';
        const animationDuration = bm.property.animationDuration || 0.8;
        const staggerDelay = bm.property.staggerDelay || 0.2;

        // 헤더 애니메이션
        const title = container.querySelector('.case-studies-title');
        if (title) {
          title.setAttribute('data-animated', 'true');
          title.style.animation = `${animationType} ${animationDuration}s ease forwards 0s`;
        }

        const subtitle = container.querySelector('.case-studies-subtitle');
        if (subtitle) {
          subtitle.setAttribute('data-animated', 'true');
          subtitle.style.animation = `${animationType} ${animationDuration}s ease forwards ${staggerDelay}s`;
        }

        // 카드 애니메이션
        const caseCards = container.querySelectorAll('.case-card');
        caseCards.forEach((card, index) => {
          card.setAttribute('data-animated', 'true');
          const delay = (2 + index) * staggerDelay;
          card.style.animation = `${animationType} ${animationDuration}s ease forwards ${delay}s`;
          card.style.opacity = '0';
        });
      }

      // 회사 로고 이미지 로드 확인
      const logoImages = container.querySelectorAll('.case-company-logo img');
      logoImages.forEach((img) => {
        img.addEventListener('error', (e) => {
          // 이미지 로드 실패 시 로고 박스 숨김
          e.target.parentElement.style.opacity = '0.3';
        });
      });
    } catch (error) {
      console.error('Case studies initialization failed:', error);
    }
  }

  initCaseStudies();

  bm.onContextChange = () => {
    initCaseStudies();
  };

  bm.onDestroy = () => {
    // cleanup if needed
  };
</script>

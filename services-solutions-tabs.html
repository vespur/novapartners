<style>
  .tabs-container {
    width: 100%;
    background-color: var(--color-background-100);
    padding: {{property.paddingY}}px {{property.paddingX}}px;
  }

  .tabs-wrapper {
    max-width: 1200px;
    margin: 0 auto;
  }

  /* 탭 버튼 네비게이션 */
  .tabs-nav {
    display: flex;
    gap: {{property.tabGap}}px;
    border-bottom: {{property.borderWidth}}px solid var(--color-border-100);
    margin-bottom: {{property.tabContentGap}}px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }

  .tab-button {
    padding: {{property.tabPaddingY}}px {{property.tabPaddingX}}px;
    background: none;
    border: none;
    cursor: pointer;
    font-size: {{property.tabFontSize}}px;
    font-family: var(--font-family-body);
    font-weight: var(--font-weight-body);
    color: var(--color-text-60);
    white-space: nowrap;
    position: relative;
    transition: color 0.3s ease;
    padding-bottom: {{property.tabPaddingY}}px;
  }

  .tab-button:hover {
    color: var(--color-text-100);
  }

  .tab-button.active {
    color: var(--color-accent-100);
    font-weight: 600;
  }

  /* 활성 탭 밑줄 */
  .tab-button.active::after {
    content: '';
    position: absolute;
    bottom: -{{property.borderWidth}}px;
    left: 0;
    right: 0;
    height: {{property.borderWidth}}px;
    background-color: var(--color-accent-100);
  }

  /* 탭 콘텐츠 */
  .tabs-content {
    display: none;
  }

  .tabs-content.active {
    display: block;
    animation: fadeIn 0.3s ease;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  /* 반응형 */
  @media (max-width: 768px) {
    .tabs-container {
      padding: {{property.mobilePaddingY}}px {{property.mobilePaddingX}}px;
    }

    .tab-button {
      font-size: {{property.mobileTabFontSize}}px;
      padding: {{property.mobileTabPaddingY}}px {{property.mobileTabPaddingX}}px;
    }

    .tabs-nav {
      gap: {{property.mobileTabGap}}px;
      margin-bottom: {{property.mobileTabContentGap}}px;
    }
  }

  /* 성능 최적화 */
  .tab-button {
    transform: translateZ(0);
    backface-visibility: hidden;
  }
</style>

<template>
  <div class="tabs-container">
    <div class="tabs-wrapper">
      <!-- 탭 버튼 네비게이션 -->
      <div class="tabs-nav">
        {{#each property.tabs}}
          <button
            class="tab-button {{#if @first}}active{{/if}}"
            data-tab-index="{{@index}}"
            type="button"
          >
            {{name}}
          </button>
        {{/each}}
      </div>

      <!-- 탭 콘텐츠 -->
      {{#each property.tabs}}
        <div
          class="tabs-content {{#if @first}}active{{/if}}"
          data-content-index="{{@index}}"
        >
          {{{content}}}
        </div>
      {{/each}}
    </div>
  </div>
</template>

<script>
  const container = bm.container;
  const context = bm.context;

  function initTabs() {
    const buttons = container.querySelectorAll('.tab-button');
    const contents = container.querySelectorAll('.tabs-content');

    // 이벤트 위임으로 탭 클릭 처리
    container.addEventListener('click', (e) => {
      const button = e.target.closest('.tab-button');
      if (!button) return;

      const tabIndex = parseInt(button.getAttribute('data-tab-index'));

      // 모든 버튼과 콘텐츠에서 active 제거
      buttons.forEach((btn) => btn.classList.remove('active'));
      contents.forEach((content) => content.classList.remove('active'));

      // 선택된 탭에 active 추가
      button.classList.add('active');
      contents[tabIndex]?.classList.add('active');
    });
  }

  initTabs();

  // 설정 변경 시 재초기화
  bm.onContextChange = () => {
    initTabs();
  };
</script>
